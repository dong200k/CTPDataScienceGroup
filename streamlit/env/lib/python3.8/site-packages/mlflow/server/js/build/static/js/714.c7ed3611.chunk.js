"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[714],{41714:function(e,t,r){r.r(t),r.d(t,{ExperimentPage:function(){return Br},default:function(){return Or}});var n=r(14585),a=r(32048),s=r.n(a),i=r(4519),l=r(50284),o=r(37850),c=r(28928);const d=c.I0;var u=r(77537);const m=(0,i.createContext)(null),p=e=>{let{children:t,actions:r}=e;const[n,s]=(0,i.useState)([]),[c,p]=(0,i.useState)(!1),[h,g]=(0,i.useState)(null),f=d(),y=(0,i.useCallback)((e=>{g(null),(()=>{const t=e.map((e=>{const t=r.getExperimentApi(e);return f(t).catch((e=>{o.Z.logErrorAndNotifyUser(e)})),t.meta.id}));s((e=>(0,a.isEqual)(t,e)?e:t))})()}),[r,f]),v=(0,i.useMemo)((()=>({fetchExperiments:y,isLoadingExperiment:c,requestError:h,actions:r})),[r,y,c,h]);return(0,u.tZ)(m.Provider,{value:v,children:(0,u.tZ)(l.ZP,{shouldOptimisticallyRender:!0,requestIds:n,children:(e,r,a)=>(p(a.some((e=>n.includes(e.id)&&e.active))),h||a.forEach((e=>{e.error&&g(e.error)})),t)})})};var h=r(96585),g=r(67437),f=r(9394),y=r(26155);var v=r.p+"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg";function S(e){let{errorMessage:t}=e;const{theme:r}=(0,h.mrf)();return(0,u.BX)("div",{className:"center",children:[(0,u.tZ)("img",{style:{height:300,marginTop:80},src:v,alt:"permission denied"}),(0,u.tZ)("h1",{style:{paddingTop:10},children:"Permission Denied"}),(0,u.tZ)("h2",{"data-testid":"error-message",css:(0,y.iv)({color:r.colors.textSecondary},""),children:t||"The current user does not have permission to view this page."})]})}var Z=r(91994);const x=e=>{let{artifactLocation:t}=e;return(0,u.tZ)(u.HY,{children:t})},b=i.memo((e=>{let{experiment:t}=e;return(0,u.BX)("div",{css:E.container,children:[(0,u.BX)(h.ZT$.Text,{color:"secondary",children:[(0,u.tZ)(Z.Z,{id:"PZGZHV",defaultMessage:"Experiment ID"}),": ",t.experiment_id]}),(0,u.BX)(h.ZT$.Text,{color:"secondary",children:[(0,u.tZ)(Z.Z,{id:"8/7V3S",defaultMessage:"Artifact Location"}),": ",(0,u.tZ)(x,{artifactLocation:t.artifact_location})]})]})})),E={container:e=>({display:"flex",gap:e.spacing.lg})};var C=r(83934),R=r(2664),M=r(29709),k=r(24374);const T=()=>{const e=(0,i.useContext)(m);if(!e)throw new Error("Trying to use GetExperimentsContext actions outside of the context!");return e},I=i.memo((e=>{let{experiment:t}=e;const r=(0,c.v9)((e=>{const r=(0,M.aq)(t.experiment_id,e);return r?(e=>{var t;return(null===(t=Object.values(e).find((e=>e.getKey()===k._)))||void 0===t?void 0:t.value)||void 0})(r):""})),[n,a]=(0,i.useState)(!1),{actions:{setExperimentTagApi:s}}=T(),l=d(),o=(0,i.useCallback)((e=>{const r=s(t.experiment_id,k._,e);l(r).then((()=>a(!1)))}),[t.experiment_id,s,l]);return(0,u.tZ)(C.a,{title:(0,u.BX)("span",{css:w.collapsibleSectionHeader,children:[(0,u.tZ)(Z.Z,{id:"wDwAdX",defaultMessage:"Description"})," ",!n&&(0,u.tZ)(h.zxk,{type:"link",onClick:()=>a(!0),children:(0,u.tZ)(Z.Z,{id:"2YEXRM",defaultMessage:"Edit"})})]}),forceOpen:n,defaultCollapsed:!r,"data-test-id":"experiment-notes-section",children:(0,u.tZ)(R.U,{defaultMarkdown:r,onSubmit:o,onCancel:()=>a(!1),showEditor:n})})})),w={collapsibleSectionHeader:{height:"32px",lineHeight:"32px"}};var N=r(983);const A="showTrackingHelper",D=i.memo((()=>{const e=(t=g.NW,(0,i.useMemo)((()=>N.Z.getStoreForComponent("ExperimentView",t)),[t]));var t;const r=(0,i.useCallback)((()=>{e.setItem(A,"false")}),[e]);return"false"!==e.getItem(A)?(0,u.BX)(u.HY,{children:[(0,u.tZ)(h.bZj,{message:(0,u.tZ)(Z.Z,{id:"YLvpXM",defaultMessage:"Track machine learning training runs in experiments. <link>Learn more</link>",values:{link:e=>(0,u.tZ)("a",{href:g.Sr,target:"_blank",rel:"noopener noreferrer",children:e})}}),type:"info",closable:!0,onClose:r}),(0,u.tZ)(h.LZC,{size:"medium"})]}):null}));var L=r(98750),B=r(12187),O=r(40869);function P(){var e=i.useContext(B._y);return(0,O.lq)(e),e}const _=e=>{let{experiment:t}=e;const r=P();return(0,u.tZ)(h.ZT$.Text,{size:"xl",dangerouslySetAntdProps:{copyable:{text:t.name,icon:(0,u.tZ)(h.TIy,{}),tooltips:[r.formatMessage({id:"A7R0ii",defaultMessage:"Copy path"}),r.formatMessage({id:"JCboZ7",defaultMessage:"Path copied"})]}}})},U=e=>{let{copyText:t}=e;const[r,n]=(0,i.useState)(!1);return(0,u.tZ)(h.ua7,{title:(0,u.tZ)(Z.Z,{id:"X+boXI",defaultMessage:"Copied"}),dangerouslySetAntdProps:{visible:r},children:(0,u.tZ)(h.zxk,{type:"primary",onClick:()=>{navigator.clipboard.writeText(t),n(!0),setTimeout((()=>{n(!1)}),3e3)},onMouseLeave:()=>{n(!1)},children:(0,u.tZ)(Z.Z,{id:"1Iq+NW",defaultMessage:"Copy"})})})};var $={name:"490tlg",styles:"display:flex;gap:4px"};const K=e=>{let{copyText:t}=e;return(0,u.BX)("div",{css:$,children:[(0,u.tZ)(h.IIB,{readOnly:!0,value:t,"data-test-id":"copy-box"}),(0,u.tZ)(U,{copyText:t})]})},X=e=>{let{visible:t,onCancel:r,link:n}=e;return(0,u.tZ)(h.u_l,{title:(0,u.tZ)(Z.Z,{id:"ktiuki",defaultMessage:"Get Link"}),visible:t,onCancel:r,children:(0,u.tZ)(K,{copyText:n})})},V=()=>{var e;const[t,r]=(0,i.useState)(!1);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(X,{link:(null===(e=window.top)||void 0===e?void 0:e.location.href)||window.location.href,visible:t,onCancel:()=>r(!1)}),(0,u.tZ)(h.zxk,{type:"primary",onClick:()=>r(!0),"data-test-id":"share-button",children:(0,u.tZ)(Z.Z,{id:"2oFAO4",defaultMessage:"Share"})})]})},z=i.memo((e=>{let{experiment:t}=e;const r=(0,i.useMemo)((()=>t.name.split("/").pop()),[t.name]);return(0,u.tZ)(L.mr,{title:(0,u.BX)(u.HY,{children:[r," ",(0,u.tZ)(_,{experiment:t})]}),breadcrumbs:[],children:(0,u.tZ)(V,{})})})),F=i.memo((e=>{let{experiments:t}=e;const r=(0,i.useMemo)((()=>(0,u.tZ)(Z.Z,{id:"Dhn7Mb",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:t.length}})),[t.length]);return(0,u.tZ)(L.mr,{title:r,breadcrumbs:[],children:(0,u.tZ)(V,{})})}));let H,W;!function(e){e.ACTIVE="Active",e.DELETED="Deleted"}(H||(H={})),function(e){e.WITH_MODEL_VERSIONS="With Model Versions",e.WTIHOUT_MODEL_VERSIONS="Without Model Versions",e.ALL_RUNS="All Runs"}(W||(W={}));var j=r(2010);const q=(e,t)=>{const{experiments:r}=t,n=r.map((e=>e.experiment_id)),a=n.length>1,s=Object.values(e.entities.runInfosByUuid).filter((e=>{let{experiment_id:t}=e;return n.includes(t)})).map((e=>{let{run_uuid:t}=e;return t})),{modelVersionsByRunUuid:i,runUuidsMatchingFilter:l}=e.entities,o=((e,t,r)=>{let{lifecycleFilter:n=H.ACTIVE,modelVersionFilter:a=W.ALL_RUNS}=r;const{modelVersionsByRunUuid:s}=t.entities;return e.map((e=>(0,M.hQ)(e,t))).filter((e=>n===H.ACTIVE?"active"===e.lifecycle_stage:"deleted"===e.lifecycle_stage)).filter((e=>a===W.ALL_RUNS||(a===W.WITH_MODEL_VERSIONS?e.run_uuid in s:a===W.WTIHOUT_MODEL_VERSIONS?!(e.run_uuid in s):(console.warn("Invalid input to model version filter - defaulting to showing all runs."),!0))))})(s,e,t),c=new Set,d=new Set,u=o.map((t=>{const r=(0,j.nQ)(t.run_uuid,e),n=Object.values(r||{});return n.forEach((e=>{c.add(e.key)})),n})),m=o.map((t=>{const r=Object.values((0,M.Qf)(t.run_uuid,e));return r.forEach((e=>{d.add(e.key)})),r})),p=o.map((t=>(0,M.Ml)(t.run_uuid,e))),h=n[0];return{modelVersionsByRunUuid:i,experimentTags:a?{}:(0,M.aq)(h,e),runInfos:o,paramsList:m,tagsList:p,metricsList:u,runUuidsMatchingFilter:l,metricKeyList:Array.from(c.values()).sort(),paramKeyList:Array.from(d.values()).sort()}};var Y=r(46285),G=r(43270),Q=r.n(G),J=r(2166);class ee extends i.Component{constructor(){super(...arguments),this.state={toggled:!1},this.handleToggle=()=>{this.setState((e=>({toggled:!e.toggled}))),this.props.onToggle&&this.props.onToggle()}}render(){if(this.props.children.length<=this.props.showLines)return(0,u.tZ)("div",{css:te,children:this.props.children.map(((e,t)=>(0,u.tZ)("div",{className:"expandable-list-item",children:e},t)))});{const e=this.props.children.slice(this.props.showLines).map(((e,t)=>(0,u.tZ)("div",{className:"expandable-list-item",children:e},t))),t=(0,u.BX)("div",{className:"expanded-list-elems",children:[e,(0,u.tZ)("div",{onClick:this.handleToggle,className:"expander-text",children:"Less"})]}),r=(0,u.BX)("div",{onClick:this.handleToggle,className:"expander-text",children:["+",this.props.children.length-this.props.showLines," more"]});return(0,u.BX)("div",{css:te,children:[this.props.children.slice(0,this.props.showLines).map(((e,t)=>(0,u.tZ)("div",{className:"expandable-list-item",children:e},t))),this.state.toggled?t:r]})}}}ee.defaultProps={showLines:1};const te={".expander-text":{textDecoration:"underline",cursor:"pointer"}};var re=ee;var ne=r.p+"static/media/registryIcon.45763d5027ff453b5352e32a9802c012.svg";const ae=e=>{let{text:t,maxSize:r,className:n,allowShowMore:a=!1}=e;if(t.length<=r)return(0,u.tZ)("span",{className:n,children:t});const s=`${t.substr(0,r)}...`,[l,o]=(0,i.useState)(!1);return(0,u.BX)("span",{className:n,children:[l?t:s,a&&(0,u.tZ)(h.zxk,{type:"link",onClick:()=>o(!l),size:"small",css:se.expandButton,"data-test-id":"trimmed-text-button",children:l?"collapse":"expand"})]})},se={expandButton:{display:"inline-block"}};function ie(){const{theme:e}=(0,h.mrf)();return(0,u.tZ)(h.rsQ,{css:(0,y.iv)({color:e.colors.textValidationDanger},"")})}function le(){const{theme:e}=(0,h.mrf)();return(0,u.tZ)(h.OcG,{css:(0,y.iv)({color:e.colors.textValidationSuccess},"")})}class oe{static getCheckboxForRow(e,t,r){const n=`${r}`;return(0,u.tZ)(n,{className:"run-table-container",children:(0,u.tZ)("div",{children:(0,u.tZ)("input",{type:"checkbox",checked:e,onChange:t})})},"meta-check")}static getRunStatusIcon(e){switch(e){case"FAILED":case"KILLED":return(0,u.tZ)(ie,{});case"FINISHED":return(0,u.tZ)(le,{});case"SCHEDULED":return(0,u.tZ)(h.T39,{});default:return(0,u.tZ)("i",{})}}static csvEscape(e){return void 0===e?"":/[,"\r\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e}static tableToCsv(e,t){let r,n="";for(r=0;r<e.length;r++)n+=oe.csvEscape(e[r]),r<e.length-1&&(n+=",");for(n+="\n",r=0;r<t.length;r++){for(let e=0;e<t[r].length;e++)n+=oe.csvEscape(t[r][e]),e<t[r].length-1&&(n+=",");n+="\n"}return n}static runInfosToCsv(e,t,r,n,a,s,i){const l=["Start Time","Duration","Run ID","Name","Source Type","Source Name","User","Status",...t,...r,...n],c=e.map(((e,l)=>{const c=[o.Z.formatTimestamp(e.start_time),o.Z.getDuration(e.start_time,e.end_time)||"",e.run_uuid,o.Z.getRunNameFromTags(i[l]),o.Z.getSourceType(i[l]),o.Z.getSourceName(i[l]),o.Z.getUser(e,i[l]),e.status],d=oe.toParamsMap(a[l]),u=oe.toMetricsMap(s[l]),m=i[l];return t.forEach((e=>{d[e]?c.push(d[e].getValue()):c.push("")})),r.forEach((e=>{u[e]?c.push(u[e].getValue()):c.push("")})),n.forEach((e=>{m[e]?c.push(m[e].getValue()):c.push("")})),c}));return oe.tableToCsv(l,c)}static getSortIcon(e,t,r){if(e===r)return(0,u.tZ)("span",{children:(0,u.tZ)("i",{className:t?"fas fa-caret-up":"fas fa-caret-down",style:oe.styles.sortIconStyle})})}static getSelectAllCheckbox(e,t,r){const n=`${r}`;return(0,u.tZ)(n,{className:"bottom-row run-table-container",children:(0,u.tZ)("input",{type:"checkbox",onChange:e,checked:t})},"meta-check")}static getRunMetadataHeaderCells(e,t,r,n,a){const s=`${n}`,i=new Set(a);return[{key:"status",canonicalSortKey:null},{key:"start_time",displayName:Y.z.DATE,canonicalSortKey:Y.XZ.DATE},{key:"duration",displayName:Y.z.DURATION,canonicalSortKey:null},{key:"user_id",displayName:Y.z.USER,canonicalSortKey:Y.XZ.USER},{key:"run_name",displayName:Y.z.RUN_NAME,canonicalSortKey:Y.XZ.RUN_NAME},{key:"source",displayName:Y.z.SOURCE,canonicalSortKey:Y.XZ.SOURCE},{key:"source_version",displayName:Y.z.VERSION,canonicalSortKey:Y.XZ.VERSION},{key:"tags",displayName:"Tags",canonicalSortKey:null},{key:"linked-models",displayName:"Linked Models",canonicalSortKey:null}].filter((e=>!i.has(e.displayName))).map((n=>((n,a,i)=>{const l=oe.getSortIcon(t,r,i),o=null!==i,c=Q()("run-table-container",{sortable:o});return(0,u.BX)(s,{className:c,onClick:()=>o?e(i,!r):null,children:[(0,u.tZ)("span",{children:a}),o&&(0,u.tZ)("span",{style:oe.styles.sortIconContainer,children:l})]},"meta-"+n)})(n.key,(0,u.tZ)("span",{children:n.displayName}),n.canonicalSortKey)))}static makeCanonicalKey(e,t){return e+".`"+t+"`"}static getExpanderHeader(e){const t=`${e}`;return(0,u.tZ)(t,{className:"bottom-row run-table-container",style:{width:"5px"}},"meta-expander")}static getUnbaggedMetricCell(e,t,r,n){const a="left-border run-table-container",s="metric-"+e,i=`${n}`;if(t[e]){const n=t[e].getValue(),l=r[e];let c=1;l.max>l.min&&(c=(n-l.min)/(l.max-l.min));const d=100*c+"%";return(0,u.tZ)(i,{className:a,children:(0,u.tZ)("div",{children:(0,u.BX)("div",{className:"metric-filler-bg",children:[(0,u.tZ)("div",{className:"metric-filler-fg",style:{width:d}}),(0,u.tZ)("div",{className:"metric-text",children:o.Z.formatMetric(n)})]})})},s)}return(0,u.tZ)(i,{className:a},s)}static getUnbaggedParamCell(e,t,r){const n=`${r}`,a="left-border run-table-container",s="param-"+e;return t[e]?(0,u.tZ)(n,{className:a,children:(0,u.tZ)("div",{children:t[e].getValue()})},s):(0,u.tZ)(n,{className:a},s)}static renderLinkedModelCell(e){const{name:t,version:r}=e;return(0,u.BX)("div",{className:"version-link",children:[(0,u.tZ)("img",{src:ne,alt:"MLflow Model Registry Icon"}),(0,u.tZ)("span",{className:"model-link-text",children:(0,u.BX)("a",{href:o.Z.getIframeCorrectedRoute((0,J.u5)(t,r)),className:"model-version-link",title:`${t}, v${r}`,style:{verticalAlign:"middle"},target:"_blank",children:[(0,u.tZ)(ae,{text:t,maxSize:10,className:"model-name"}),(0,u.BX)("span",{children:["/",r,"\xa0"]})]})})]})}static getLinkedModelCell(e,t){return e&&e.length>0?(0,u.tZ)("div",{className:"run-table-container",children:(0,u.tZ)(re,{children:e.map((e=>this.renderLinkedModelCell(e))),showLines:1,onToggle:t})},"linked=models"):null}static computeMetricRanges(e){const t={};return e.forEach((e=>{e.forEach((e=>{t.hasOwnProperty(e.key)?(e.value<t[e.key].min&&(t[e.key].min=Math.min(e.value,.7*e.value)),e.value>t[e.key].max&&(t[e.key].max=e.value)):t[e.key]={min:Math.min(e.value,.7*e.value),max:e.value}}))})),t}static toMetricsMap(e){const t={};return e.forEach((e=>{t[e.key]=e})),t}static toParamsMap(e){const t={};return e.forEach((e=>{t[e.key]=e})),t}static isExpanderOpen(e,t){let r=Y.QK;return void 0!==e[t]&&(r=e[t]),r}static getExpander(e,t,r,n,a){const s=`${a}`;return e?t?(0,u.tZ)(s,{onClick:r,style:{padding:8},children:(0,u.tZ)("i",{className:"ExperimentView-expander far fa-minus-square-o"})},"Expander-"+n):(0,u.tZ)(s,{onClick:r,style:{padding:8},children:(0,u.tZ)("i",{className:"ExperimentView-expander far fa-plus-square-o"})},"Expander-"+n):(0,u.tZ)(s,{style:{padding:8}},"Expander-"+n)}static getNestedRowRenderMetadata(e){let{runInfos:t,tagsList:r,runsExpanded:n}=e;const a={};t.forEach(((e,t)=>{a[e.run_uuid]=t}));const s=t.map((e=>new ce(e.run_uuid)));r.forEach(((e,t)=>{const r=e["mlflow.parentRunId"];if(r){const e=a[r.value];void 0!==e&&(s[t].parent=s[e])}}));const i={},l=[];s.forEach(((e,t)=>{const{parent:r}=e;if(void 0!==r&&r.value!==e.value){const e=i[r.value];let n;e?(e.push(t),n=e):n=[t],i[r.value]=n}else l.push(t)}));const o=[],c=new Set;return l.forEach((e=>{!function e(r,a){if(!c.has(r)){const s=t[r].run_uuid;let l;l=i[s]?{idx:r,isParent:!0,hasExpander:!0,expanderOpen:oe.isExpanderOpen(n,s),childrenIds:i[s].map((e=>t[e].run_uuid)),runId:s,level:a}:{idx:r,isParent:!1,hasExpander:!1,level:a},o.push(l),c.add(r);const d=i[l.runId];d&&oe.isExpanderOpen(n,l.runId)&&d.forEach((t=>{e(t,a+1)}))}}(e,0)})),o.slice(0)}static getRowRenderMetadata(e){let{runInfos:t,tagsList:r,runsExpanded:n,nestChildren:a}=e;return a?this.getNestedRowRenderMetadata({runInfos:t,tagsList:r,runsExpanded:n}):[...Array(t.length).keys()].map((e=>({idx:e,isParent:!0,hasExpander:!1,runId:t[e].run_uuid})))}static getRows(e){let{runInfos:t,tagsList:r,runsExpanded:n,getRow:a}=e;return oe.getRowRenderMetadata({runInfos:t,tagsList:r,runsExpanded:n}).map((e=>a(e)))}static renderRows(e){return e.map((e=>{const t=e.isChild?{backgroundColor:"#fafafa"}:{};return(0,u.tZ)("tr",{style:t,className:"ExperimentView-row",children:e.contents},e.key)}))}static disableLoadMoreButton(e){let{numRunsFromLatestSearch:t,nextPageToken:r}=e;return null!==t&&null===r}static getCategorizedUncheckedKeysDiffView(e){let{categorizedUncheckedKeys:t,paramKeyList:r,metricKeyList:n,runInfos:a,paramsList:i,metricsList:l,tagsList:c}=e;const d={[Y.z.RUN_NAME]:o.Z.runNameTag,[Y.z.VERSION]:o.Z.gitCommitTag,[Y.z.MODELS]:o.Z.loggedModelsTag},u=Object.keys(d),m=o.Z.getVisibleTagKeyList(c);let p=s().difference(u,t[Y.D5.ATTRIBUTES]),h=s().difference(r,t[Y.D5.PARAMS]),g=s().difference(n,t[Y.D5.METRICS]),f=s().difference(m,t[Y.D5.TAGS]);const y=(e,t,r)=>e.filter((e=>{const n=t[e],a=r[e];return!n&&!a||!(!n||!a)&&n.getValue()===a.getValue()}));for(const[s]of a.entries())if(p=p.filter((e=>!(d[e]in c[s]))),0!==s&&(h=y(h,oe.toParamsMap(i[s-1]),oe.toParamsMap(i[s])),g=y(g,oe.toMetricsMap(l[s-1]),oe.toMetricsMap(l[s])),f=y(f,c[s-1],c[s]),0===p.length&&0===h.length&&0===g.length&&0===f.length))break;return{[Y.D5.ATTRIBUTES]:s().concat(t[Y.D5.ATTRIBUTES],p),[Y.D5.PARAMS]:s().concat(t[Y.D5.PARAMS],h),[Y.D5.METRICS]:s().concat(t[Y.D5.METRICS],g),[Y.D5.TAGS]:s().concat(t[Y.D5.TAGS],f)}}static getRestoredCategorizedUncheckedKeys(e){let{preSwitchCategorizedUncheckedKeys:t,postSwitchCategorizedUncheckedKeys:r,currCategorizedUncheckedKeys:n}=e;const a=e=>{const a=s().difference(r[e],n[e]),i=s().difference(n[e],r[e]);return s().uniq(s().without(s().concat(t[e],i),...a))};return{[Y.D5.ATTRIBUTES]:a(Y.D5.ATTRIBUTES),[Y.D5.PARAMS]:a(Y.D5.PARAMS),[Y.D5.METRICS]:a(Y.D5.METRICS),[Y.D5.TAGS]:a(Y.D5.TAGS)}}}oe.styles={sortIconStyle:{verticalAlign:"middle",fontSize:20},sortIconContainer:{marginLeft:2,minWidth:12.5,display:"inline-block"},expander:{pointer:"cursor"},runInfoCell:{maxWidth:250}};class ce{constructor(e){this.value=e,this.parent=void 0}findRoot(){const e=new Set([this.value]);let t=this;for(;void 0!==t.parent;){if(e.has(t.parent.value))return;e.add(t.value),t=t.parent}return t}isRoot(){return this.findRoot().value===this.value}isCycle(){return void 0===this.findRoot()}}var de=r(62632);const ue="$$$param$$$",me="$$$metric$$$",pe="$$$tag$$$",he="mlflow.parentRunId";var ge=r(76082),fe=r(86509),ye=r(13e3);class ve extends i.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.deleteRunApi(t))})),Promise.all(e).catch((()=>{this.props.openErrorModal("While deleting an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,u.tZ)(ye.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Delete Experiment ${o.Z.pluralize("Run",e)}`,helpText:(0,u.BX)("div",{children:[(0,u.tZ)("p",{children:(0,u.BX)("b",{children:[e," experiment ",o.Z.pluralize("run",e)," will be deleted."]})}),""]}),confirmButtonText:"Delete"})}}const Se={deleteRunApi:n.Gd,openErrorModal:n.yQ};var Ze=(0,c.$j)(null,Se)(ve),xe=r(11616);class be extends i.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.restoreRunApi(t))})),Promise.all(e).catch((e=>{this.props.openErrorModal("While restoring an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,u.tZ)(ye.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Restore Experiment ${o.Z.pluralize("Run",e)}`,helpText:`${e} experiment ${o.Z.pluralize("run",e)} will be restored.`,confirmButtonText:"Restore"})}}const Ee={restoreRunApi:n.Y1,openErrorModal:n.yQ};var Ce=(0,c.$j)(null,Ee)(be),Re=r(22637),Me=r.n(Re);const ke=()=>{var e;const t=(0,ge.$B)(),r=(0,ge.TH)(),n=(0,i.useMemo)((()=>decodeURIComponent(r.search)),[r.search]),a=(0,i.useMemo)((()=>{const e=Me().parse(n.substring(1));if(e.experiments){const t=e.experiments;return(null===t||void 0===t?void 0:t.toString())||""}return""}),[n]);return(0,i.useMemo)((()=>{var e,r;if(null!==(e=t.params)&&void 0!==e&&e.experimentId)return[null===(r=t.params)||void 0===r?void 0:r.experimentId];if(a)try{return JSON.parse(a)}catch{return o.Z.logErrorAndNotifyUser(`Could not parse experiment query parameter ${a}`),""}return[]}),[a,null===(e=t.params)||void 0===e?void 0:e.experimentId])};var Te=r(29009),Ie=r(25272);const we={ALL:null,LAST_HOUR:36e5,LAST_24_HOURS:864e5,LAST_7_DAYS:6048e5,LAST_30_DAYS:2592e6,LAST_YEAR:31104e6},Ne=(e,t)=>!(0,a.isEqual)(e.searchFilter,t.searchFilter)||!(0,a.isEqual)(e.orderByAsc,t.orderByAsc)||!(0,a.isEqual)(e.orderByKey,t.orderByKey)||!(0,a.isEqual)(e.lifecycleFilter,t.lifecycleFilter)||!(0,a.isEqual)(e.startTime,t.startTime),Ae=(e,t,r,n)=>{const a=t.lifecycleFilter===H.ACTIVE?Ie.bW.ACTIVE_ONLY:Ie.bW.DELETED_ONLY,{runsPinned:s}=t,i=(e=>{let{orderByKey:t,orderByAsc:r}=e;return t?r?[t+" ASC"]:[t+" DESC"]:[]})(t),l=((e,t)=>{let{startTime:r}=e;const n=we[r];return r&&n&&"ALL"!==r?"attributes.start_time >= "+(t-n):null})(t,r),o=((e,t)=>{let{searchFilter:r}=e;return r&&t?`${r} and ${t}`:!r&&t?t:r||void 0})(t,l);return{experimentIds:e,filter:o,runViewType:a,orderBy:i,shouldFetchParents:(e=>{let{orderByKey:t,searchFilter:r}=e;return!t&&!r||t===Y.XZ.DATE})(t),pageToken:n,runsPinned:s}},De=(e,t,r)=>{const n=e.filter((e=>e.data.tags.some((e=>"mlflow.log-model.history"===e.key))));(0,a.chunk)(n,Te.mc).forEach((e=>{const n=t({run_id:e.map((e=>e.info.run_id))});r(n)}))};class Le extends i.Component{handleSortBy(){const{canonicalSortKey:e,orderByAsc:t,orderByKey:r}=this.props;let n=!t;e!==r&&(n=!1),this.props.onSortBy(e,n)}render(){const{enableSorting:e,canonicalSortKey:t,displayName:r,getClassName:n=(()=>""),orderByKey:a,orderByAsc:s}=this.props;return(0,u.BX)("div",{role:"columnheader",css:Be.headerLabelWrapper,className:n(t),onClick:e?()=>this.handleSortBy():void 0,children:[e&&t===a?(0,u.tZ)("span",{style:Be.headerSortIcon,children:(0,u.tZ)("i",{className:"fa fa-long-arrow-"+(s?"up":"down")})}):null,(0,u.tZ)("span",{"data-test-id":`sort-header-${r}`,children:r})]})}}const Be={headerLabelWrapper:{height:"100%",width:"100%",display:"flex",alignItems:"center",padding:"0 12px"},headerSortIcon:{marginRight:4}},Oe=()=>(0,u.tZ)(h.rsQ,{css:e=>({color:e.colors.textValidationDanger})}),Pe=()=>(0,u.tZ)(h.OcG,{css:e=>({color:e.colors.textValidationSuccess})}),_e=e=>{switch(e){case"FAILED":case"KILLED":return(0,u.tZ)(Oe,{});case"FINISHED":return(0,u.tZ)(Pe,{});case"SCHEDULED":return(0,u.tZ)(h.T39,{});default:return null}},Ue=i.memo((e=>{let{value:{startTime:t,referenceTime:r,runStatus:n}}=e;return(0,u.BX)("span",{css:$e.cellWrapper,title:o.Z.formatTimestamp(t),children:[_e(n),o.Z.timeSinceStr(t,r)]})})),$e={cellWrapper:e=>({display:"flex",alignItems:"center",gap:e.spacing.sm,svg:{width:14,height:14}})};var Ke=r(17032);const Xe=i.memo((e=>{let{data:t,value:r}=e;return(0,u.tZ)(Ke.rU,{to:fe.Z.getExperimentPageRoute(t.experimentId),title:r.name,children:r.basename})}));var Ve=r.p+"static/media/logged-model.dd9b21ff4fb07f3cadeada8046a2693b.svg";var ze=r.p+"static/media/registered-model.24429a4f6158e57b01b3928e2605aa25.svg";const Fe=i.memo((e=>{const{registeredModels:t,loggedModels:r,experimentId:n,runUuid:a}=e.value,s=o.Z.mergeLoggedAndRegisteredModels(r,t);if(s&&s.length){const e=s[0];let t;if(e.registeredModelName){const{registeredModelName:r,registeredModelVersion:n}=e;t=(0,u.BX)(u.HY,{children:[(0,u.tZ)("img",{"data-test-id":"registered-model-icon",alt:"",title:"Registered Model",src:ze}),(0,u.BX)("a",{href:o.Z.getIframeCorrectedRoute((0,J.u5)(r,n)),className:"registered-model-link",target:"_blank",rel:"noreferrer",children:[(0,u.tZ)(ae,{text:r,maxSize:10,className:"model-name"}),`/${n}`]})]})}else if(e.flavors){const r=e.flavors?e.flavors[0]:"Model",s=o.Z.getIframeCorrectedRoute(`${fe.Z.getRunPageRoute(n,a)}/artifactPath/${e.artifactPath}`);t=(0,u.BX)(u.HY,{children:[(0,u.tZ)("img",{"data-test-id":"logged-model-icon",alt:"",title:"Logged Model",src:Ve}),(0,u.tZ)("a",{href:s,target:"_blank",className:"logged-model-link",children:r})]})}return(0,u.BX)("div",{className:"logged-model-cell",css:He.imageWrapper,children:[t,r.length>1?`, ${r.length-1} more`:""]})}return(0,u.tZ)(u.HY,{children:"-"})})),He={imageWrapper:{img:{height:"15px",position:"relative",marginRight:"4px"}}},We=i.memo((e=>{let{value:t}=e;const r=o.Z.renderSource(t,void 0,void 0);return r?(0,u.BX)(u.HY,{children:[o.Z.renderSourceTypeIcon(t),r]}):(0,u.tZ)(u.HY,{children:"-"})})),je=i.memo((e=>{let{value:{version:t,name:r,type:n}}=e;return o.Z.renderSourceVersion(t,r,n)||(0,u.tZ)(u.HY,{children:"-"})})),qe=i.memo((e=>e.data.pinnable?(0,u.tZ)(h.ua7,{placement:"right",title:e.value?(0,u.tZ)(Z.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,u.tZ)(Z.Z,{id:"/Rt/Lj",defaultMessage:"Click to pin the run"}),children:(0,u.BX)("label",{css:Ye.pinWrapper,children:[(0,u.tZ)("input",{type:"checkbox",checked:e.value,onChange:()=>{e.onTogglePin(e.data.runUuid)}}),e.value?(0,u.tZ)(h.D$V,{}):(0,u.tZ)(h.qKU,{})]})}):null)),Ye={pinWrapper:e=>({input:{width:0,appearance:"none"},cursor:"pointer",display:"inline-block",svg:{width:14,height:14,cursor:"pointer",color:"transparent"},".ag-row-hover & svg":{color:e.colors.grey600},"input:checked + span svg":{color:e.colors.grey600}})},Ge=i.memo((e=>{let{onExpand:t,data:{runName:r,experimentId:n,runUuid:a,runDateAndNestInfo:s}}=e;const{hasExpander:i,expanderOpen:l,childrenIds:o,level:c}=s||{},d=!isNaN(c)&&i;return(0,u.BX)("div",{css:Qe.cellWrapper,children:[(0,u.tZ)("div",{css:Qe.expanderWrapper,children:(0,u.tZ)("div",{css:Qe.nestLevel(c),children:d&&(0,u.tZ)(h.zxk,{css:Qe.expanderButton,size:"small",onClick:()=>{t(a,o)},type:"link",icon:l?(0,u.tZ)(h.uSo,{}):(0,u.tZ)(h.IAe,{})},"Expander-"+a)})}),(0,u.tZ)(Ke.rU,{to:fe.Z.getRunPageRoute(n,a),children:r})]})})),Qe={link:e=>({display:"inline-block",minWidth:e.typography.fontSizeBase,minHeight:e.typography.fontSizeBase}),cellWrapper:{display:"flex"},expanderButton:{svg:{width:12,height:12}},expanderWrapper:{display:"none",".ag-grid-expanders-visible &":{display:"block"}},nestLevel:e=>t=>({display:"flex",justifyContent:"flex-end",width:(e+1)*t.spacing.lg})},Je=(e,t)=>e+".`"+t+"`",et=(e,t)=>e.startsWith(t),tt={[Y.XZ.USER]:Je(Y.D5.ATTRIBUTES,"User"),[Y.XZ.RUN_NAME]:Je(Y.D5.ATTRIBUTES,"Run Name"),[Y.XZ.SOURCE]:Je(Y.D5.ATTRIBUTES,"Source"),[Y.XZ.VERSION]:Je(Y.D5.ATTRIBUTES,"Version")},rt=e=>{let{data:t}=e;return t.runUuid},nt=[Y.z.USER,Y.z.SOURCE,Y.z.VERSION,Y.z.MODELS],at=[Y.z.EXPERIMENT_NAME,...nt],st=e=>{let{searchFacetsState:t,onSortBy:r,compareExperiments:n,onTogglePin:s,onExpand:l,paramKeyList:c,metricKeyList:d,tagKeyList:u,columnApi:m}=e;const{orderByAsc:p,orderByKey:h,selectedColumns:g}=t,f=(e=>{let{paramKeyList:t,metricKeyList:r,tagKeyList:n}=e;const a=(0,i.useRef)(new Set),s=(0,i.useRef)(new Set),l=(0,i.useRef)(new Set),o=(0,i.useMemo)((()=>(t.forEach((e=>s.current.add(e))),Array.from(s.current))),[t]),c=(0,i.useMemo)((()=>(r.forEach((e=>a.current.add(e))),Array.from(a.current))),[r]),d=(0,i.useMemo)((()=>(n.forEach((e=>l.current.add(e))),Array.from(l.current))),[n]);return(0,i.useMemo)((()=>({paramKeys:o,metricKeys:c,tagKeys:d})),[c,o,d])})({metricKeyList:d,tagKeyList:u,paramKeyList:c}),y=(0,i.useMemo)((()=>{const e={orderByKey:h,orderByAsc:p,onSortBy:r},t=e=>e===h?"is-ordered-by":void 0,i=e=>t(e),c=e=>{let{colDef:r}=e;return t(r.headerComponentParams.canonicalSortKey)},d=[];d.push({field:"pinned",checkboxSelection:!0,headerName:"",headerCheckboxSelection:!0,cellRenderer:"PinRowCellRenderer",cellRendererParams:{onTogglePin:s},pinned:"left",minWidth:70,width:70,maxWidth:70,resizable:!1}),d.push({headerName:Y.z.RUN_NAME,colId:tt[Y.XZ.RUN_NAME],headerTooltip:Y.XZ.RUN_NAME,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"RunNameCellRenderer",cellRendererParams:{onExpand:l},equals:a.isEqual,headerComponentParams:{...e,canonicalSortKey:Y.XZ.RUN_NAME,getClassName:i},cellClass:c,initialWidth:260}),d.push({headerName:Y.z.DATE,headerTooltip:Y.XZ.DATE,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"DateCellRenderer",cellRendererParams:{onExpand:l},equals:a.isEqual,headerComponentParams:{...e,canonicalSortKey:Y.XZ.DATE,getClassName:i},cellClass:c,initialWidth:150}),d.push({headerName:Y.z.DURATION,field:"duration",initialWidth:80,cellClass:c}),n&&d.push({headerName:Y.z.EXPERIMENT_NAME,colId:Je(Y.D5.ATTRIBUTES,Y.z.EXPERIMENT_NAME),field:"experimentName",cellRenderer:"ExperimentNameCellRenderer",equals:(e,t)=>(0,a.isEqual)(e,t),initialWidth:140,cellClass:c,initialHide:!0}),d.push({headerName:Y.z.USER,colId:tt[Y.XZ.USER],headerTooltip:Y.XZ.USER,field:"user",sortable:!0,headerComponentParams:{...e,canonicalSortKey:Y.XZ.USER,getClassName:i},cellClass:c,initialHide:!0}),d.push({headerName:Y.z.SOURCE,colId:tt[Y.XZ.SOURCE],field:"tags",cellRenderer:"SourceCellRenderer",equals:(e,t)=>o.Z.getSourceName(e)===o.Z.getSourceName(t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:Y.XZ.SOURCE,getClassName:i},cellClass:c,initialHide:!0}),d.push({headerName:Y.z.VERSION,colId:tt[Y.XZ.VERSION],field:"version",cellRenderer:"VersionCellRenderer",equals:(e,t)=>(0,a.isEqual)(e,t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:Y.XZ.VERSION,getClassName:i},cellClass:c,initialHide:!0}),d.push({headerName:Y.z.MODELS,colId:Je(Y.D5.ATTRIBUTES,Y.z.MODELS),field:"models",cellRenderer:"ModelsCellRenderer",initialWidth:200,equals:(e,t)=>(0,a.isEqual)(e,t),initialHide:!0});const{metricKeys:u,paramKeys:m,tagKeys:g}=f;return u.length&&d.push({headerName:"Metrics",colId:Y.D5.METRICS,children:u.map((t=>{const r=Je(Y.D5.METRICS,t);return{headerName:t,colId:r,headerTooltip:r,field:(n=t,`$$$metric$$$-${n}`),initialWidth:100,initialHide:!0,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:i},cellClass:c};var n}))}),m.length&&d.push({headerName:"Parameters",colId:Y.D5.PARAMS,children:m.map((t=>{const r=Je(Y.D5.PARAMS,t);return{colId:r,headerName:t,headerTooltip:r,field:(n=t,`$$$param$$$-${n}`),initialHide:!0,initialWidth:100,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:i},cellClass:c};var n}))}),g.length&&d.push({headerName:"Tags",colId:Y.D5.TAGS,children:g.map((e=>{const t=Je(Y.D5.TAGS,e);return{colId:t,headerName:e,initialHide:!0,initialWidth:100,headerTooltip:t,field:(r=e,`$$$tag$$$-${r}`)};var r}))}),d}),[h,p,r,s,l,n,f]),v=(0,i.useMemo)((()=>[...at.map((e=>Je(Y.D5.ATTRIBUTES,e))),...f.paramKeys.map((e=>Je(Y.D5.PARAMS,e))),...f.metricKeys.map((e=>Je(Y.D5.METRICS,e))),...f.tagKeys.map((e=>Je(Y.D5.TAGS,e)))]),[f]);return(0,i.useEffect)((()=>{if(m)for(const e of v){const t=g.includes(e);m.setColumnVisible(e,t)}}),[g,m,v]),y},it={initialWidth:100,autoSizePadding:0,headerComponentParams:{menuIcon:"fa-bars"},resizable:!0,filter:!0,suppressMenu:!0,suppressMovable:!0},lt=[Je(Y.D5.ATTRIBUTES,Y.z.SOURCE),Je(Y.D5.ATTRIBUTES,Y.z.MODELS)];class ot{constructor(){this.searchFilter="",this.orderByKey=Y.gB,this.orderByAsc=Y.yG,this.startTime=Y.wi,this.lifecycleFilter=Y.FJ,this.modelVersionFilter=Y.oj,this.selectedColumns=[...lt],this.runsExpanded={},this.runsPinned=[]}}const ct=Object.keys(new ot),dt=(e,t,r,n)=>{if("value"===n){if("true"===e)return!0;if("false"===e)return!1;if(void 0===e)return""}return t(e)},ut=(e,t)=>Object.assign(new ot,{...e,...t});function mt(e,t){N.Z.getStoreForComponent("ExperimentPage",t).saveComponentState(e)}function pt(e){return Me().stringify(e,{addQueryPrefix:!0,arrayFormat:"comma",encodeValuesOnly:!0})}function ht(e,t){let r=new ot;try{const e=N.Z.getStoreForComponent("ExperimentPage",t).loadComponentState();(n=e).runsExpanded&&!(0,a.isObject)(n.runsExpanded)||n.selectedColumns&&!(0,a.isArray)(n.selectedColumns)||(r=ut(r,e))}catch{o.Z.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${t}`)}var n;const s=decodeURIComponent(e),i=Me().parse(s,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:dt}),{restData:l,stateData:c}=function(e){const t={},r={};for(const n in e)if(e.hasOwnProperty(n)){const a=ct.includes(n);Object.assign(a?t:r,{[n]:e[n]})}return{stateData:t,restData:r}}(i);if(!(Object.keys(c).length<1)){const e=Object.assign(new ot,c);r=ut(r,e)}return mt(r,t),{state:r,isPristine:(0,a.isEqual)(new ot,r),queryString:pt({...l,...r})}}const gt=(0,i.createContext)(null),ft=e=>{let{children:t,actions:r}=e;const n=(0,ge.k6)(),s=ke(),c=d(),[m,p]=(0,i.useState)(""),[h,g]=(0,i.useState)(!1),[f,y]=(0,i.useState)(!1),[v,S]=(0,i.useState)(null),Z=(0,i.useMemo)((()=>JSON.stringify(s.sort())),[s]),[x,b]=(0,i.useState)((()=>{const{queryString:e,state:t}=ht(n.location.search,Z);return n.location.search!==e&&n.replace(`${n.location.pathname}${e}`),t})),E=(0,i.useRef)(""),C=(0,i.useRef)(""),R=(0,i.useRef)(!0),M=(0,i.useCallback)((()=>R.current),[]),k=(0,i.useCallback)((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=arguments.length>3?arguments[3]:void 0;const s=Boolean(a);s||(C.current=n);const i=s?r.loadMoreRunsApi:r.searchRunsApi,l=i(Ae(t,e,n,a||void 0));g(!0),c(l).then((e=>{let{value:t}=e;E.current=t.next_page_token,y(Boolean(t.next_page_token)),De(t.runs||[],r.searchModelVersionsApi,c)})).catch((e=>{o.Z.logErrorAndNotifyUser(e)})),p(l.meta.id)}),[c,r]),T=(0,i.useCallback)((()=>{k(x,s,C.current||void 0,E.current||void 0)}),[k,x,s]),I=(0,i.useCallback)((()=>{k(x,s)}),[s,k,x]),w=(0,i.useCallback)((e=>{const t=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=Me().parse(r,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:dt}),{experiments:a}=n;return mt(e,t),pt({experiments:a,...e})}(e,Z,n.location.search);n.location.search!==t&&n.push(`${n.location.pathname}${t}`)}),[n,Z]),N=(0,i.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{forceRefresh:r=!1,preservePristine:n=!1}=t;b((t=>{const n=(0,a.isFunction)(e)?e(t):{...t,...e};return(r||Ne(t,n))&&k(n,s),w(n),n})),n||(R.current=!1)}),[s,k,w]);(0,i.useEffect)((()=>n.listen(((e,t)=>{if("POP"===t){const{state:t}=ht(e.search,Z);N(t)}}))),[n,Z,N]);const A=(0,i.useMemo)((()=>({actions:r,searchFacetsState:x,fetchExperimentRuns:I,updateSearchFacets:N,loadMoreRuns:T,requestError:v,isLoadingRuns:h,moreRunsAvailable:f,isPristine:M})),[r,x,I,T,v,h,N,f,M]);return(0,u.tZ)(gt.Provider,{value:A,children:(0,u.tZ)(l.ZP,{shouldOptimisticallyRender:!0,requestIds:m?[m]:[],children:(e,r,n)=>(g(n.some((e=>e.id===m&&e.active))),n.forEach((e=>{e.error&&S(e.error)})),t)})})},yt=()=>{const e=(0,i.useContext)(gt);if(!e)throw new Error("Trying to use SearchExperimentRunsContext actions outside of the context!");return e},vt=e=>{let{showDeleteRunModal:t,showRestoreRunModal:r,showRenameRunModal:n,runsSelected:a,onCloseDeleteRunModal:s,onCloseRestoreRunModal:l,onCloseRenameRunModal:o,renamedRunName:c}=e;const{updateSearchFacets:d}=yt(),m=Object.entries(a).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t})),p=(0,i.useCallback)((()=>d({},{forceRefresh:!0,preservePristine:!0})),[d]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(Ze,{isOpen:t,onClose:s,selectedRunIds:m}),(0,u.tZ)(Ce,{isOpen:r,onClose:l,selectedRunIds:m}),(0,u.tZ)(xe.UQ,{runUuid:m[0],onClose:o,runName:c,isOpen:n,onSuccess:()=>p()})]})},St=i.memo((e=>{let{viewState:t,runsData:r,searchFacetsState:n}=e;const{runsSelected:a}=t,{runInfos:s}=r,{lifecycleFilter:l}=n,o=(0,ge.k6)(),[c,d]=(0,i.useState)(!1),[m,p]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),[y,v]=(0,i.useState)(""),S=(0,i.useCallback)((()=>{const e=Object.keys(a),t=s.find((t=>t.run_uuid===e[0]));t&&(v(t.run_name),f(!0))}),[s,a]),x=(0,i.useCallback)((()=>{const e=Object.keys(a),t=s.filter((t=>{let{run_uuid:r}=t;return e.includes(r)})).map((e=>{let{experiment_id:t}=e;return t}));o.push(fe.Z.getCompareRunPageRoute(e,[...new Set(t)].sort()))}),[o,s,a]),b=(0,i.useCallback)((()=>d(!0)),[]),E=(0,i.useCallback)((()=>p(!0)),[]),C=(0,i.useCallback)((()=>d(!1)),[]),R=(0,i.useCallback)((()=>p(!1)),[]),M=(0,i.useCallback)((()=>f(!1)),[]),k=Object.values(t.runsSelected).filter(Boolean).length,T=k>0,I=1===k,w=k>1;return(0,u.BX)("div",{css:Zt.controlBar,children:[(0,u.tZ)(vt,{runsSelected:a,onCloseRenameRunModal:M,onCloseDeleteRunModal:C,onCloseRestoreRunModal:R,showDeleteRunModal:c,showRestoreRunModal:m,showRenameRunModal:g,renamedRunName:y}),(0,u.tZ)(h.zxk,{"data-testid":"runs-compare-button",disabled:!w,onClick:x,children:(0,u.tZ)(Z.Z,{id:"RaGnOQ",defaultMessage:"Compare"})}),(0,u.tZ)(h.zxk,{"data-testid":"run-rename-button",onClick:S,disabled:!I,children:(0,u.tZ)(Z.Z,{id:"oWPgX7",defaultMessage:"Rename"})}),(0,u.tZ)("div",{css:Zt.gapElement}),l===Y.VW.ACTIVE?(0,u.tZ)(h.zxk,{"data-testid":"runs-delete-button",disabled:!T,onClick:b,danger:!0,children:(0,u.tZ)(Z.Z,{id:"3Rb4sG",defaultMessage:"Delete"})}):null,l===Y.VW.DELETED?(0,u.tZ)(h.zxk,{"data-testid":"runs-restore-button",disabled:!T,onClick:E,children:(0,u.tZ)(Z.Z,{id:"Potju2",defaultMessage:"Restore"})}):null]})})),Zt={controlBar:{display:"flex",gap:8,alignItems:"center"},gapElement:{flex:1}};var xt=r(17564),bt=r(4942),Et=r(71002),Ct=r(87462),Rt=r(58804),Mt=r(25831),kt=r(90690),Tt=r(29439);function It(e){var t,r=e.prefixCls,n=e.value,a=e.current,s=e.offset,l=void 0===s?0:s;return l&&(t={position:"absolute",top:"".concat(l,"00%"),left:0}),i.createElement("span",{style:t,className:Q()("".concat(r,"-only-unit"),{current:a})},n)}function wt(e,t,r){for(var n=e,a=0;(n+10)%10!==t;)n+=r,a+=r;return a}function Nt(e){var t,r,n=e.prefixCls,a=e.count,s=e.value,l=Number(s),o=Math.abs(a),c=i.useState(l),d=(0,Tt.Z)(c,2),u=d[0],m=d[1],p=i.useState(o),h=(0,Tt.Z)(p,2),g=h[0],f=h[1],y=function(){m(l),f(o)};if(i.useEffect((function(){var e=setTimeout((function(){y()}),1e3);return function(){clearTimeout(e)}}),[l]),u===l||Number.isNaN(l)||Number.isNaN(u))t=[i.createElement(It,(0,Ct.Z)({},e,{key:l,current:!0}))],r={transition:"none"};else{t=[];for(var v=l+10,S=[],Z=l;Z<=v;Z+=1)S.push(Z);var x=S.findIndex((function(e){return e%10===u}));t=S.map((function(t,r){var n=t%10;return i.createElement(It,(0,Ct.Z)({},e,{key:t,value:n,offset:r-x,current:r===x}))})),r={transform:"translateY(".concat(-wt(u,l,g<o?1:-1),"00%)")}}return i.createElement("span",{className:"".concat(n,"-only"),style:r,onTransitionEnd:y},t)}var At=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Dt=function(e){var t=e.prefixCls,r=e.count,n=e.className,a=e.motionClassName,s=e.style,l=e.title,o=e.show,c=e.component,d=void 0===c?"sup":c,u=e.children,m=At(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),p=(0,i.useContext(Mt.E_).getPrefixCls)("scroll-number",t),h=(0,Ct.Z)((0,Ct.Z)({},m),{"data-show":o,style:s,className:Q()(p,n,a),title:l}),g=r;if(r&&Number(r)%1===0){var f=String(r).split("");g=f.map((function(e,t){return i.createElement(Nt,{prefixCls:p,count:Number(r),value:e,key:f.length-t})}))}return s&&s.borderColor&&(h.style=(0,Ct.Z)((0,Ct.Z)({},s),{boxShadow:"0 0 0 1px ".concat(s.borderColor," inset")})),u?(0,kt.Tm)(u,(function(e){return{className:Q()("".concat(p,"-custom-component"),null===e||void 0===e?void 0:e.className,a)}})):i.createElement(d,h,g)},Lt=r(71235);function Bt(e){return-1!==Lt.Y.indexOf(e)}var Ot=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Pt=function(e){var t,r,n=e.prefixCls,a=e.scrollNumberPrefixCls,s=e.children,l=e.status,o=e.text,c=e.color,d=e.count,u=void 0===d?null:d,m=e.overflowCount,p=void 0===m?99:m,h=e.dot,g=void 0!==h&&h,f=e.size,y=void 0===f?"default":f,v=e.title,S=e.offset,Z=e.style,x=e.className,b=e.showZero,E=void 0!==b&&b,C=Ot(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","showZero"]),R=i.useContext(Mt.E_),M=R.getPrefixCls,k=R.direction,T=M("badge",n),I=u>p?"".concat(p,"+"):u,w=null!==l&&void 0!==l||null!==c&&void 0!==c,N="0"===I||0===I,A=g&&!N||w,D=A?"":I,L=(0,i.useMemo)((function(){return(null===D||void 0===D||""===D||N&&!E)&&!A}),[D,N,E,A]),B=(0,i.useRef)(u);L||(B.current=u);var O=B.current,P=(0,i.useRef)(D);L||(P.current=D);var _=P.current,U=(0,i.useRef)(A);L||(U.current=A);var $=(0,i.useMemo)((function(){if(!S)return(0,Ct.Z)({},Z);var e={marginTop:S[1]};return"rtl"===k?e.left=parseInt(S[0],10):e.right=-parseInt(S[0],10),(0,Ct.Z)((0,Ct.Z)({},e),Z)}),[k,S,Z]),K=null!==v&&void 0!==v?v:"string"===typeof O||"number"===typeof O?O:void 0,X=L||!o?null:i.createElement("span",{className:"".concat(T,"-status-text")},o),V=O&&"object"===(0,Et.Z)(O)?(0,kt.Tm)(O,(function(e){return{style:(0,Ct.Z)((0,Ct.Z)({},$),e.style)}})):void 0,z=Q()((t={},(0,bt.Z)(t,"".concat(T,"-status-dot"),w),(0,bt.Z)(t,"".concat(T,"-status-").concat(l),!!l),(0,bt.Z)(t,"".concat(T,"-status-").concat(c),Bt(c)),t)),F={};c&&!Bt(c)&&(F.background=c);var H=Q()(T,(r={},(0,bt.Z)(r,"".concat(T,"-status"),w),(0,bt.Z)(r,"".concat(T,"-not-a-wrapper"),!s),(0,bt.Z)(r,"".concat(T,"-rtl"),"rtl"===k),r),x);if(!s&&w){var W=$.color;return i.createElement("span",(0,Ct.Z)({},C,{className:H,style:$}),i.createElement("span",{className:z,style:F}),i.createElement("span",{style:{color:W},className:"".concat(T,"-status-text")},o))}return i.createElement("span",(0,Ct.Z)({},C,{className:H}),s,i.createElement(Rt.Z,{visible:!L,motionName:"".concat(T,"-zoom"),motionAppear:!1},(function(e){var t,r=e.className,n=M("scroll-number",a),s=U.current,o=Q()((t={},(0,bt.Z)(t,"".concat(T,"-dot"),s),(0,bt.Z)(t,"".concat(T,"-count"),!s),(0,bt.Z)(t,"".concat(T,"-count-sm"),"small"===y),(0,bt.Z)(t,"".concat(T,"-multiple-words"),!s&&_&&_.toString().length>1),(0,bt.Z)(t,"".concat(T,"-status-").concat(l),!!l),(0,bt.Z)(t,"".concat(T,"-status-").concat(c),Bt(c)),t)),d=(0,Ct.Z)({},$);return c&&!Bt(c)&&((d=d||{}).background=c),i.createElement(Dt,{prefixCls:n,show:!L,motionClassName:r,className:o,count:_,title:K,style:d,key:"scrollNumber"},V)})),X)};Pt.Ribbon=function(e){var t,r=e.className,n=e.prefixCls,a=e.style,s=e.color,l=e.children,o=e.text,c=e.placement,d=void 0===c?"end":c,u=i.useContext(Mt.E_),m=u.getPrefixCls,p=u.direction,h=m("ribbon",n),g=Bt(s),f=Q()(h,"".concat(h,"-placement-").concat(d),(t={},(0,bt.Z)(t,"".concat(h,"-rtl"),"rtl"===p),(0,bt.Z)(t,"".concat(h,"-color-").concat(s),g),t),r),y={},v={};return s&&!g&&(y.background=s,v.color=s),i.createElement("div",{className:"".concat(h,"-wrapper")},l,i.createElement("div",{className:f,style:(0,Ct.Z)((0,Ct.Z)({},y),a)},i.createElement("span",{className:"".concat(h,"-text")},o),i.createElement("div",{className:"".concat(h,"-corner"),style:v})))};var _t=Pt;const Ut=i.memo((e=>{let{runInfos:t}=e;const{actions:{searchRunsPayload:r},updateSearchFacets:n}=yt(),a=ke(),[s,l]=(0,i.useState)(0),[o,c]=(0,i.useState)(0),d=(0,i.useCallback)((()=>n({},{forceRefresh:!0,preservePristine:!0})),[n]);return(0,i.useEffect)((()=>{c(0),l((()=>Date.now()))}),[t]),(0,i.useEffect)((()=>{if(!s)return;const e=setInterval((()=>{const e={experimentIds:a,filter:`attributes.start_time > ${s}`,maxResults:Y.mz};r(e).then((e=>{var t;const r=(null===(t=e.runs)||void 0===t?void 0:t.length)||0;c(r)}))}),Y.FK);return()=>clearInterval(e)}),[s,r,a]),(0,u.tZ)(_t,{count:o,offset:[-5,5],css:$t.pill,overflowCount:Y.mz-1,children:(0,u.tZ)(h.zxk,{onClick:d,"data-testid":"runs-refresh-button",icon:(0,u.tZ)(h.bnu,{}),children:(0,u.tZ)(Z.Z,{id:"ag05Pe",defaultMessage:"Refresh"})})})})),$t={pill:e=>({sup:{backgroundColor:e.colors.lime,zIndex:1}})},Kt=(0,c.$j)((e=>({runInfos:e.entities.runInfosByUuid})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities===t.entities})(Ut),Xt="GROUP",Vt=Je(Xt,Y.D5.ATTRIBUTES),zt=Je(Xt,Y.D5.PARAMS),Ft=Je(Xt,Y.D5.METRICS),Ht=Je(Xt,Y.D5.TAGS),Wt=[Y.z.USER,Y.z.SOURCE,Y.z.VERSION,Y.z.MODELS],jt=[Y.z.EXPERIMENT_NAME,...Wt],qt=(e,t)=>e.filter((e=>e.toLowerCase().includes(t.toLowerCase()))),Yt=(e,t)=>{if(!t)return e;const r=e.toLowerCase().indexOf(t.toLowerCase()),n=e.substring(0,r),a=e.substring(r,r+t.length),s=e.substring(r+t.length);return r>-1?(0,u.BX)("span",{children:[n,(0,u.tZ)("strong",{children:a}),s]}):e},Gt=i.memo((e=>{let{runsData:t,columnSelectorVisible:r,onChangeColumnSelectorVisible:n,updateSearchFacets:a,selectedColumns:s}=e;const l=ke(),[c,d]=(0,i.useState)(""),m=(0,i.useRef)(null),p=(0,i.useRef)(null),g=(0,i.useRef)(null),f=(0,i.useMemo)((()=>l.length>1?jt:Wt),[l.length]),y=(0,i.useCallback)((e=>a((t=>{const r=e(t.selectedColumns),n=Array.from(new Set(r));return{...t,selectedColumns:n}}))),[a]),v=(0,i.useMemo)((()=>o.Z.getVisibleTagKeyList(t.tagsList)),[t]),S=(0,i.useMemo)((()=>({[Y.D5.ATTRIBUTES]:f.map((e=>Je(Y.D5.ATTRIBUTES,e))),[Y.D5.PARAMS]:t.paramKeyList.map((e=>Je(Y.D5.PARAMS,e))),[Y.D5.METRICS]:t.metricKeyList.map((e=>Je(Y.D5.METRICS,e))),[Y.D5.TAGS]:v.map((e=>Je(Y.D5.TAGS,e)))})),[t,f,v]),x=(0,i.useMemo)((()=>{const e=[],r=qt(f,c),n=qt(t.paramKeyList,c),a=qt(t.metricKeyList,c),s=qt(v,c);return r.length&&e.push({key:Vt,title:"Attributes",children:r.map((e=>({key:Je(Y.D5.ATTRIBUTES,e),title:Yt(e,c)})))}),a.length&&e.push({key:Ft,title:`Metrics (${a.length})`,children:a.map((e=>({key:Je(Y.D5.METRICS,e),title:Yt(e,c)})))}),n.length&&e.push({key:zt,title:`Parameters (${n.length})`,children:n.map((e=>({key:Je(Y.D5.PARAMS,e),title:Yt(e,c)})))}),s.length&&e.push({key:Ht,title:`Tags (${s.length})`,children:s.map((e=>({key:Je(Y.D5.TAGS,e),title:e})))}),e}),[f,c,t,v]),b=(0,i.useCallback)(((e,t)=>{y(e?e=>e.filter((e=>!t.includes(e))):e=>[...e,...t])}),[y]),E=(0,i.useCallback)(((e,t)=>{y(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[y]);(0,i.useEffect)((()=>{r&&(d(""),requestAnimationFrame((()=>{var e,t;null===p||void 0===p||null===(e=p.current)||void 0===e||e.scrollTo(0,0),null===(t=m.current)||void 0===t||t.focus({preventScroll:!0}),g.current&&g.current.scrollIntoView({block:"nearest",behavior:"smooth"})})))}),[r]);const C=(0,i.useCallback)(((e,t)=>{let{node:{key:r,checked:n}}=t;if(et(r.toString(),Xt)){const e=(a=r.toString(),s=Xt,a.substring(s.length+2).slice(0,-1)),t=S[e];t&&b(n,qt(t,c))}else E(r.toString(),n);var a,s}),[S,b,E,c]),R=(0,i.useCallback)((e=>{if("ArrowDown"===e.key){const e=(null===(t=p.current)||void 0===t?void 0:t.querySelector('[role="tree"] input'))||null;e&&e.focus()}var t}),[]),M=(0,u.BX)("div",{css:Jt.dropdown,children:[(0,u.tZ)("div",{css:e=>({padding:e.spacing.md}),children:(0,u.tZ)(h.IIB,{value:c,prefix:(0,u.tZ)(h.vlt,{}),placeholder:"Search columns",allowClear:!0,ref:m,onChange:e=>{d(e.target.value)},onKeyDown:R})}),(0,u.tZ)("div",{ref:p,css:Jt.scrollableContainer,children:(0,u.tZ)(h.mpN,{"data-testid":"column-selector-tree",mode:"checkable",dangerouslySetAntdProps:{checkedKeys:s,onCheck:C},defaultExpandedKeys:[Vt,zt,Ft,Ht],treeData:x})})]});return(0,u.tZ)(h.Ltx,{overlay:M,placement:"bottomRight",trigger:["click"],visible:r,onVisibleChange:n,children:(0,u.BX)(h.zxk,{ref:g,style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",children:[(0,u.tZ)(Z.Z,{id:"ny+fBZ",defaultMessage:"Columns"})," ",(0,u.tZ)(h.v4q,{})]})})})),Qt=e=>{const{updateSearchFacets:t,searchFacetsState:r}=yt();return(0,u.tZ)(Gt,{...e,selectedColumns:r.selectedColumns,updateSearchFacets:t})},Jt={dropdown:e=>({backgroundColor:e.colors.white,width:400,border:"1px solid",borderColor:e.colors.border}),scrollableContainer:e=>({maxHeight:480,overflowY:"scroll",overflowX:"hidden",paddingBottom:e.spacing.md,"span[title]":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})},er=i.memo((e=>{let{searchFacetsState:t,updateSearchFacets:r,runsData:n,viewState:a,updateViewState:s,onDownloadCsv:l,sortOptions:o}=e;const{lifecycleFilter:c,orderByKey:d,orderByAsc:m,startTime:p}=t,[f,y]=(0,i.useState)(),v=P(),S=(0,i.useMemo)((()=>(e=>({ALL:e.formatMessage({id:"a/TbnY",defaultMessage:"All time"}),LAST_HOUR:e.formatMessage({id:"bjoGjg",defaultMessage:"Last hour"}),LAST_24_HOURS:e.formatMessage({id:"JChRnq",defaultMessage:"Last 24 hours"}),LAST_7_DAYS:e.formatMessage({id:"eQsXm7",defaultMessage:"Last 7 days"}),LAST_30_DAYS:e.formatMessage({id:"p1H1KR",defaultMessage:"Last 30 days"}),LAST_YEAR:e.formatMessage({id:"EI7moF",defaultMessage:"Last year"})}))(v)),[v]),x=(0,i.useCallback)((e=>{let{value:t}=e;const[n,a]=t.split(Y.T_),s=tt[n]||n,i=a===Y.aU;r((e=>{const{selectedColumns:t}=e;return t.includes(s)||t.push(s),{...e,selectedColumns:t,orderByKey:n,orderByAsc:i}}))}),[r]);(0,i.useEffect)((()=>{y(t.searchFilter)}),[t]);const b=(0,i.useCallback)((()=>{const e=new ot,{selectedColumns:n,runsExpanded:a,runsPinned:s}=t;r(Object.assign(e,{runsExpanded:a,runsPinned:s,selectedColumns:n}))}),[t,r]),E=(0,i.useCallback)((e=>s({columnSelectorVisible:e})),[s]),C=(0,i.useMemo)((()=>`${d}${Y.T_}${m?Y.aU:Y.iX}`),[m,d]),R=(0,i.useMemo)((()=>{const e=o.find((e=>e.value===C));let t=null===e||void 0===e?void 0:e.label;if(!t){const e=d.match(/^.+\.`(.+)`$/);e&&(t=e[1])}return(0,u.BX)(u.HY,{children:[(0,u.tZ)(Z.Z,{id:"llrWuc",defaultMessage:"Sort"}),": ",m?(0,u.tZ)(h.Hf3,{}):(0,u.tZ)(h.veu,{})," ",t]})}),[C,m,d,o]),M=(0,u.BX)(u.HY,{children:[(0,u.tZ)(Z.Z,{id:"OGWg8l",defaultMessage:"State:"})," ",c]}),k=(0,u.BX)(u.HY,{children:[(0,u.tZ)(Z.Z,{id:"9Ce4Gd",defaultMessage:"Started during"}),": ",S[p]]});return(0,u.tZ)(u.HY,{children:(0,u.BX)("div",{css:tr.groupBar,children:[(0,u.BX)("div",{css:tr.controlBar,children:[(0,u.tZ)(Kt,{}),(0,u.tZ)("div",{css:tr.searchBox,children:(0,u.tZ)(h.IIB,{value:f,prefix:(0,u.tZ)(h.vlt,{css:tr.searchBarIcon}),onKeyDown:e=>{"Enter"===e.key&&r({searchFilter:f})},onChange:e=>y(e.target.value),placeholder:'metrics.rmse < 1 and params.model = "tree"',"data-test-id":"search-box",suffix:(0,u.BX)("div",{css:tr.searchInputSuffix,children:[f&&(0,u.tZ)(h.zxk,{onClick:b,type:"link","data-test-id":"clear-button",children:(0,u.tZ)(h.Two,{})}),(0,u.tZ)(h.ua7,{title:(0,u.BX)("div",{className:"search-input-tooltip-content",children:[(0,u.tZ)(Z.Z,{id:"sXjD3p",defaultMessage:"Search runs using a simplified version of the SQL {whereBold} clause",values:{whereBold:(0,u.tZ)("b",{children:"WHERE"})}}),(0,u.tZ)("br",{}),(0,u.tZ)(Z.Z,{id:"nYKZy4",defaultMessage:"<link>Learn more</link>",values:{link:e=>(0,u.tZ)("a",{href:g.Kp,target:"_blank",rel:"noopener noreferrer",children:e})}})]}),placement:"bottom",children:(0,u.tZ)(h.MLt,{css:tr.searchBarIcon})})]})})}),(0,u.tZ)(h.PhF,{className:"sort-select",css:tr.sortSelectControl,value:{value:C,label:R},labelInValue:!0,dangerouslySetAntdProps:{virtual:!1,dropdownStyle:tr.sortSelectDropdown},onChange:x,"data-test-id":"sort-select-dropdown",children:o.map((e=>(0,u.BX)(h.Wxm,{title:e.label,"data-test-id":`sort-select-${e.label}-${e.order}`,value:e.value,children:[e.order===Y.aU?(0,u.tZ)(h.Hf3,{}):(0,u.tZ)(h.veu,{})," ",(0,xt.mJ)(e.label,50)]},e.value)))}),(0,u.BX)(h.PhF,{value:{value:c,label:M},labelInValue:!0,"data-testid":"lifecycle-filter",onChange:e=>{let{value:t}=e;return r({lifecycleFilter:t})},children:[(0,u.tZ)(h.PhF.Option,{"data-testid":"active-runs-menu-item",value:H.ACTIVE,children:(0,u.tZ)(Z.Z,{id:"0pdAuV",defaultMessage:"Active"})}),(0,u.tZ)(h.PhF.Option,{"data-testid":"deleted-runs-menu-item",value:H.DELETED,children:(0,u.tZ)(Z.Z,{id:"yJpGwW",defaultMessage:"Deleted"})})]}),(0,u.tZ)(h.PhF,{className:"start-time-select",value:{value:p,label:k},labelInValue:!0,onChange:e=>{let{value:t}=e;r({startTime:t})},"data-test-id":"start-time-select-dropdown",dangerouslySetAntdProps:{virtual:!1},children:Object.keys(S).map((e=>(0,u.tZ)(h.Wxm,{title:S[e],"data-test-id":`start-time-select-${e}`,value:e,children:S[e]},e)))}),(0,u.tZ)(h.ua7,{title:v.formatMessage({id:"vPmud2",defaultMessage:"Download CSV"}),children:(0,u.BX)(h.zxk,{className:"csv-button",onClick:l,children:[(0,u.tZ)(h._8t,{})," ",(0,u.tZ)(Z.Z,{id:"yJu+hX",defaultMessage:"Download"})]})})]}),(0,u.tZ)("div",{css:tr.groupSeparator}),(0,u.tZ)(Qt,{columnSelectorVisible:a.columnSelectorVisible,onChangeColumnSelectorVisible:E,runsData:n})]})})})),tr={groupBar:{display:"grid",gridTemplateColumns:"auto 1fr auto"},controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center"}),searchBarIcon:e=>({svg:{width:16,height:16,color:e.colors.textSecondary}}),groupSeparator:e=>({minWidth:e.spacing.sm}),searchInputSuffix:{display:"flex",gap:4,alignItems:"center"},columnSwitch:{margin:"5px"},searchBox:e=>({display:"flex",gap:e.spacing.sm,width:360}),sortSelectControl:{minWidth:140,maxWidth:360},lifecycleFilters:e=>({display:"flex",gap:8,alignItems:"center",marginTop:e.spacing.sm,marginBottom:e.spacing.sm,marginLeft:2*e.spacing.lg}),sortSelectDropdown:{minWidth:360}},rr=i.memo((e=>{let{runsData:t,viewState:r,updateViewState:n,updateSearchFacets:a,searchFacetsState:s}=e;const{paramKeyList:l,metricKeyList:c,tagsList:d}=t,m=l,p=c,h=o.Z.getVisibleTagKeyList(d),g=(0,i.useCallback)((()=>((e,t,r,n)=>{const{runInfos:a,paramsList:s,metricsList:i,tagsList:l}=e,o=oe.runInfosToCsv(a,r,n,t,s,i,l),c=new Blob([o],{type:"application/csv;charset=utf-8"});(0,de.saveAs)(c,"runs.csv")})(t,h,m,p)),[p,m,h,t]),f=((e,t)=>(0,i.useMemo)((()=>{let r=[];const n=[Y.aU,Y.iX];return r=[...Object.keys(Y.Ul).reduce(((e,t)=>{const r=Y.Ul[t];return n.forEach((n=>{e.push({label:r,value:Y.XZ[t]+Y.T_+n,order:n})})),e}),[]),...e.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${oe.makeCanonicalKey(Y.D5.METRICS,t)}${Y.T_}${r}`,order:r})})),e)),[]),...t.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${oe.makeCanonicalKey(Y.D5.PARAMS,t)}${Y.T_}${r}`,order:r})})),e)),[])],r}),[e,t]))(p,m),y=Object.values(r.runsSelected).filter(Boolean).length;return(0,u.tZ)("div",{css:nr.wrapper,children:y>0?(0,u.tZ)(St,{runsData:t,updateSearchFacets:a,searchFacetsState:s,viewState:r}):(0,u.tZ)(er,{onDownloadCsv:g,updateSearchFacets:a,searchFacetsState:s,viewState:r,updateViewState:n,sortOptions:f,runsData:t})})})),nr={wrapper:{display:"flex",gap:8,flexDirection:"column",marginTop:12}},ar=i.lazy((()=>Promise.all([r.e(547),r.e(869)]).then(r.bind(r,49869)))),sr=e=>(0,u.tZ)(i.Suspense,{fallback:(0,u.tZ)("div",{css:e=>({display:"flex",justifyContent:"center",margin:e.spacing.md}),children:(0,u.tZ)(h.$jN,{})}),children:(0,u.tZ)(ar,{...e})});class ir extends i.Component{constructor(){super(...arguments),this.getLearnMoreLinkUrl=()=>g.gM}render(){const e=this.getLearnMoreLinkUrl();return(0,u.tZ)("div",{className:"experiment-runs-table-empty-overlay",css:lr.wrapper,children:(0,u.tZ)("span",{children:(0,u.tZ)(Z.Z,{id:"bq+LYL",defaultMessage:"No runs yet. <link>Learn more</link> about how to create ML model training {newLine} runs in this experiment.",values:{link:t=>(0,u.tZ)("a",{target:"_blank",href:e,children:t}),newLine:(0,u.tZ)("br",{})}})})})}}const lr={wrapper:{position:"relative",top:"10px",fontSize:"13px",padding:"30px",width:"100 %",pointerEvents:"all"}},or=e=>e.map(((e,t)=>{var r;let{runInfo:n,metrics:a=[],params:s=[],tags:i={}}=e;return{index:t,runInfo:n,level:0,isPinnable:!(null!==(r=i["mlflow.parentRunId"])&&void 0!==r&&r.value),metrics:a,params:s,tags:i}})),cr=(e,t,r)=>{if(!e)return[];const n={};for(const a of t)n[`${r}-${a}`]="-";for(const{key:s,value:i}of e)(i||(0,a.isNumber)(i))&&(n[`${r}-${s}`]=i);return n},dr=e=>{let{experiments:t,modelVersionsByRunUuid:r,runsExpanded:n,nestChildren:a,referenceTime:s,paramKeyList:i,metricKeyList:l,tagKeyList:c,runsPinned:d,runData:u,runUuidsMatchingFilter:m}=e;const p=o.Z.getExperimentNameMap(o.Z.sortExperimentsById(t)),h=a?(e=>{let{runsExpanded:t,runData:r}=e;const n={};r.forEach(((e,t)=>{let{runInfo:r}=e;n[r.run_uuid]=t}));const a=r.map((e=>{let{runInfo:t}=e;return{value:t.run_uuid}}));let s=!1;if(r.forEach(((e,t)=>{let{tags:r}=e;const i=null===r||void 0===r?void 0:r["mlflow.parentRunId"];if(i){const e=n[i.value];void 0!==e&&(s=!0,a[t].parent=a[e])}})),!s)return or(r);const i={},l=[];a.forEach(((e,t)=>{const{parent:r}=e;void 0!==r&&r.value!==e.value?i[r.value]?i[r.value].push(t):i[r.value]=[t]:l.push(t)}));const o=[],c=new Set,d=(e,n)=>{if(!c.has(e)){const a=r[e].runInfo,s=a.run_uuid,u=Boolean(l.includes(e))||0===n,m={index:e,isParent:!1,hasExpander:!1,level:n,runInfo:a,params:r[e].params||[],metrics:r[e].metrics||[],tags:r[e].tags||{},isPinnable:u};i[s]&&(m.isParent=!0,m.hasExpander=!0,m.expanderOpen=Boolean(t[s]),m.childrenIds=i[s].map((e=>r[e].runInfo.run_uuid))),o.push(m),c.add(e);const p=i[s];p&&t[s]&&p.forEach((e=>{d(e,n+1)}))}};return l.forEach((e=>{d(e,0)})),o})({runData:u,runsExpanded:n}):or(u),g=[],f=h.map((e=>{const{runInfo:t,isParent:n=!1,hasExpander:a=!1,level:u=0,expanderOpen:m=!1,isPinnable:h=!1,childrenIds:f=[],tags:y,params:v,metrics:S}=e,Z=(S||[]).map((e=>{let{key:t,value:r}=e;return{key:t,value:o.Z.formatMetric(r)}})),x=t.run_uuid,{experiment_id:b}=t,E=p[b],C=o.Z.getUser(t,y),R=o.Z.getDuration(t.start_time,t.end_time),M=o.Z.getRunName(t)||t.run_uuid,k=o.Z.getVisibleTagValues(y).map((e=>{let[t,r]=e;return{key:t,value:r}})),T={startTime:t.start_time,referenceTime:s,experimentId:b,runUuid:x,runStatus:t.status,isParent:n,hasExpander:a,expanderOpen:m,childrenIds:f,level:u},I={registeredModels:r[t.run_uuid]||[],loggedModels:o.Z.getLoggedModelsFromTags(y),experimentId:t.experiment_id,runUuid:t.run_uuid},w={version:o.Z.getSourceVersion(y),name:o.Z.getSourceName(y),type:o.Z.getSourceType(y)},N=d.includes(x),A=g.includes(x);return(N||A)&&g.push(...f),{runUuid:x,runDateAndNestInfo:T,runInfo:t,experimentName:E,experimentId:b,duration:R,user:C,runName:M,tags:y,models:I,version:w,pinnable:h,pinned:N||A,...cr(v,i,ue),...cr(Z,l,me),...cr(k,c,pe)}}));return[...f.filter((e=>{let{pinned:t}=e;return t})),...f.filter((e=>{let{pinned:t,runUuid:r}=e;return!t&&m.includes(r)}))]},ur="is-out-of-viewport",mr="is-hidden",pr="is-minimized",hr=".ag-root",gr=".ag-pinned-left-cols-container",fr=".ag-center-cols-container",yr=".ag-header",vr=e=>{let{onClick:t,gridContainerElement:r,isInitialized:n,visible:a,moreAvailableParamsAndMetricsColumnCount:s=0}=e;const l=(0,i.useRef)(null),o=(0,i.useRef)(),c=(0,i.useCallback)((e=>{if(!l.current||!window.ResizeObserver||!e)return;const t=l.current,r=e.querySelector(hr),n=e.querySelector(gr),a=e.querySelector(fr),s=e.querySelector(yr);let i=0,c=0,d=0,u=0,m=0;if(n&&a&&s&&r){const e=new ResizeObserver((e=>{var l,p,h,g;for(const t of e)t.target===r&&(i=t.contentRect.width),t.target===n&&(c=t.contentRect.width,u=t.contentRect.height),t.target===s&&(m=t.contentRect.height),t.target===a&&(d=t.contentRect.width);const f=c+d,y=m;f+180>=i?null===(l=o.current)||void 0===l||l.classList.add(ur):null===(p=o.current)||void 0===p||p.classList.remove(ur);u<100?null===(h=o.current)||void 0===h||h.classList.add(pr):null===(g=o.current)||void 0===g||g.classList.remove(pr),t.style.transform=`translate3d(${f}px, ${y}px, 0)`,t.style.height=`${u+1}px`}));return e.observe(n),e.observe(a),e.observe(s),e.observe(r),()=>e.disconnect()}}),[]);return(0,i.useEffect)((()=>{n&&r&&(o.current=r,c(r))}),[c,n,r]),window.ResizeObserver?(0,u.tZ)("div",{ref:l,css:Sr.columnContainer,className:a?"":mr,children:a&&(0,u.tZ)("div",{css:Sr.buttonContainer,children:(0,u.BX)(h.zxk,{css:Sr.button,type:"link",onClick:t,children:[(0,u.tZ)(h.N9g,{css:Sr.buttonIcon}),(0,u.BX)("div",{css:Sr.caption,children:[(0,u.tZ)(Z.Z,{id:"7ASbrt",defaultMessage:"Show more metrics and parameters"})," ",s?(0,u.BX)(u.HY,{children:["(",s,")"]}):null]})]})})}):null},Sr={columnContainer:e=>({width:180,height:0,position:"absolute",border:`1px solid ${e.colors.border}`,borderLeft:0,borderTop:0,top:0,left:0,svg:{height:16,width:16},willChange:"transform",transform:"translate3d(0, 0, 0)",".is-minimized &":{display:"flex",alignItems:"center"},"&.is-hidden, .is-out-of-viewport &":{display:"none"}}),buttonContainer:e=>({position:"sticky",top:0,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg,paddingTop:e.spacing.lg,width:"100%",".is-minimized &":{paddingTop:e.spacing.xs}}),button:{whiteSpace:"pre-wrap",width:"100%"},buttonIcon:e=>({color:e.colors.textSecondary}),caption:e=>({color:e.colors.textSecondary,".is-minimized &":{display:"none"}})},Zr=()=>{const e=new Date;return e.setMilliseconds(0),e},xr=i.memo((e=>{let{experiments:t,searchFacetsState:r,runsData:n,isLoading:a,updateSearchFacets:s,updateViewState:l,onAddColumnClicked:c}=e;const{runsExpanded:d,orderByKey:m,searchFilter:p,runsPinned:g}=r,{paramKeyList:f,metricKeyList:y,tagsList:v,modelVersionsByRunUuid:S,paramsList:x,metricsList:b,runInfos:E,runUuidsMatchingFilter:C}=n,[R,M]=(0,i.useState)(),[k,T]=(0,i.useState)(),I=(0,i.useRef)([]),[w,N]=(0,i.useState)(E.length),[A,D]=(0,i.useState)(!1),L=(0,i.useMemo)((()=>o.Z.getVisibleTagKeyList(v)),[v]),B=(0,i.useRef)(null);(0,i.useEffect)((()=>{R&&(a?R.showLoadingOverlay():R.hideOverlay())}),[R,a]);const O=(0,i.useCallback)((e=>{let{api:t}=e;const r=t.getSelectedRows().map((e=>{let{runInfo:t}=e;return t.run_uuid}));l({runsSelected:r.reduce(((e,t)=>({...e,[t]:!0})),{})}),I.current=r}),[l]),P=(0,i.useCallback)((e=>{const t=e.api.getSelectedRows();if(I.current&&t.length!==I.current.length){const t=Boolean(e.node.isSelected()),{runDateAndNestInfo:r}=e.data;if(!r)return;const{isParent:n,expanderOpen:a,childrenIds:s}=r;if(n&&a&&s){const r=s;e.api.forEachNode((e=>{const{runInfo:n,runDateAndNestInfo:a}=e.data,s=n.run_uuid;r.includes(s)&&(null!==a&&void 0!==a&&a.childrenIds&&r.push(...a.childrenIds),e.setSelected(t,!1,!0))}))}}}),[]),_=(0,i.useCallback)(((e,t)=>{s({orderByKey:e,orderByAsc:t})}),[s]),U=(0,i.useCallback)((e=>s((t=>{let{runsExpanded:r,...n}=t;return{...n,runsExpanded:{...r,[e]:!r[e]}}}))),[s]),$=(0,i.useMemo)((()=>!m&&!p||m===Y.XZ.DATE),[m,p]),[K,X]=(0,i.useState)(Zr);(0,i.useEffect)((()=>{X(Zr)}),[E]),(0,i.useEffect)((()=>{if(!R||a)return;const e=dr({experiments:t,paramKeyList:f,metricKeyList:y,modelVersionsByRunUuid:S,runsExpanded:d,tagKeyList:L,nestChildren:$,referenceTime:K,runData:E.map(((e,t)=>({runInfo:e,params:x[t],metrics:b[t],tags:v[t]}))),runUuidsMatchingFilter:C,runsPinned:g});R.setRowData(e),N(e.length),D(e.some((e=>{var t;return null===(t=e.runDateAndNestInfo)||void 0===t?void 0:t.hasExpander})))}),[R,a,t,y,b,S,f,x,E,d,v,L,$,K,g,C]);const V=(0,i.useCallback)((e=>{s((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]}))),requestAnimationFrame((()=>{if(!R)return;const t=R.getRowNode(e);t&&R.redrawRows({rowNodes:[t]})}))}),[R,s]),z=st({searchFacetsState:r,onSortBy:_,onExpand:U,compareExperiments:t.length>1,onTogglePin:V,metricKeyList:y,paramKeyList:f,tagKeyList:L,columnApi:k}),F=(0,i.useCallback)((e=>{M(e.api),T(e.columnApi)}),[]),H=(0,i.useMemo)((()=>(t.length>1?at.length:nt.length)+(y.length+f.length+L.length)),[t.length,L.length,y.length,f.length]),W=r.selectedColumns.length>=H,j=(0,i.useMemo)((()=>{const e=r.selectedColumns.filter((e=>et(e,Y.D5.METRICS)||et(e,Y.D5.PARAMS))).length,t=y.length+f.length;return Math.max(0,t-e)}),[y.length,f.length,r.selectedColumns]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)("div",{css:br.runsCount,children:(0,u.tZ)(Z.Z,{id:"sHMQzu",defaultMessage:"Showing {length} matching {length, plural, =0 {runs} =1 {run} other {runs}}",values:{length:w}})}),(0,u.BX)("div",{ref:B,className:Q()("ag-theme-balham ag-grid-sticky",{"ag-grid-expanders-visible":A}),css:br.agGridOverrides,children:[(0,u.tZ)(sr,{defaultColDef:it,columnDefs:z,domLayout:"autoHeight",rowSelection:"multiple",onGridReady:F,onSelectionChanged:O,onRowSelected:P,suppressRowClickSelection:!0,suppressColumnMoveAnimation:!0,suppressScrollOnNewData:!0,suppressFieldDotNotation:!0,enableCellTextSelection:!0,components:{agColumnHeader:Le,loadingOverlayComponent:h.$jN,SourceCellRenderer:We,ModelsCellRenderer:Fe,VersionCellRenderer:je,DateCellRenderer:Ue,ExperimentNameCellRenderer:Xe,PinRowCellRenderer:qe,RunNameCellRenderer:Ge},suppressNoRowsOverlay:!0,loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:{showImmediately:!0},getRowId:rt}),!W&&(0,u.tZ)(vr,{gridContainerElement:B.current,isInitialized:Boolean(R),onClick:c,visible:!a,moreAvailableParamsAndMetricsColumnCount:j})]}),w<1&&!a&&(0,u.tZ)("div",{css:br.noResultsWrapper,children:(0,u.tZ)(ir,{})})]})})),br={runsCount:e=>({margin:`${e.spacing.md}px 0`}),noResultsWrapper:e=>({marginTop:4*-e.spacing.md,textAlign:"center",backgroundColor:e.colors.backgroundPrimary,position:"relative"}),agGridOverrides:e=>({marginTop:12,position:"relative","&.ag-theme-balham":{"--ag-border-color":"rgba(0, 0, 0, 0.06)","--ag-header-foreground-color":"#20272e","--ag-header-background-color":`${e.colors.grey100}`,"--ag-row-hover-color":`${e.colors.grey200}`,"&.ag-grid-sticky .ag-header":{position:"sticky",top:0,zIndex:1},"&.ag-grid-sticky .ag-root":{overflow:"visible"},"&.ag-grid-sticky .ag-root-wrapper":{border:"0",borderRadius:"4px",overflow:"visible"},".ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by":{backgroundColor:e.colors.blue100},".ag-header-cell":{padding:0},".ag-header-cell .ag-checkbox":{padding:"0 12px"},".ag-overlay-loading-wrapper":{paddingTop:4*e.spacing.md,alignItems:"center"},".ag-overlay-loading-wrapper .ag-react-container":{flex:1,zIndex:1},".ag-layout-auto-height .ag-center-cols-container":{borderRight:`1px solid ${e.colors.border}`,minHeight:0}}})};var Er=r(88673);class Cr{constructor(){this.runsSelected={},this.hiddenChildRunsSelected={},this.columnSelectorVisible=!1}}const Rr=e=>(0,u.tZ)(h.ua7,{placement:"bottom",title:(0,u.tZ)(Z.Z,{id:"3ioIKi",defaultMessage:"Loaded child runs are nested under their parents."}),children:e}),Mr=(0,c.$j)((e=>{const t=Object.keys(e.entities.runInfosByUuid),r=Object.entries(e.entities.tagsByRunUuid).some((e=>{let[r,n]=e;return t.includes(r)&&Object.keys(n).includes(he)}));return{containsNestedRuns:r}}))((e=>{let{loadMoreRuns:t,moreRunsAvailable:r,isLoadingRuns:n,containsNestedRuns:a}=e;const s=(0,u.tZ)(h.zxk,{type:"primary",onClick:t,disabled:!r||n,loading:n,children:(0,u.tZ)(Z.Z,{id:"9CqEWy",defaultMessage:"Load more"})});return(0,u.tZ)("div",{css:kr.loadMoreButton,children:r?a?Rr(s):s:(i=s,(0,u.tZ)(h.ua7,{placement:"bottom",title:(0,u.tZ)(Z.Z,{id:"ir96eY",defaultMessage:"No more runs to load."}),children:i}))});var i})),kr={loadMoreButton:e=>({display:"flex",justifyContent:"center",marginTop:e.spacing.md})},Tr=i.memo((e=>{const{experiments:t,runsData:r}=e,{searchFacetsState:n,updateSearchFacets:a,fetchExperimentRuns:s,isLoadingRuns:l,loadMoreRuns:o,moreRunsAvailable:c}=yt(),[d,m]=(0,i.useState)(new Cr);(0,i.useEffect)((()=>{s()}),[]);const p=(0,i.useCallback)((e=>m((t=>({...t,...e})))),[]),h=(0,i.useCallback)((()=>{p({columnSelectorVisible:!0})}),[p]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(rr,{viewState:d,updateViewState:p,runsData:r,searchFacetsState:n,updateSearchFacets:a}),(0,u.tZ)(xr,{experiments:t,runsData:r,searchFacetsState:n,viewState:d,isLoading:l,updateSearchFacets:a,updateViewState:p,onAddColumnClicked:h}),(0,u.tZ)(Mr,{isLoadingRuns:l,loadMoreRuns:o,moreRunsAvailable:c})]})})),Ir={searchRunsApi:n.ht,loadMoreRunsApi:n.mx,searchRunsPayload:n.Yl,searchModelVersionsApi:Er.nI},wr=(0,c.$j)(((e,t)=>({runsData:q(e,t)})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities===t.entities})(Tr),Nr=e=>{const{searchFacetsState:t}=yt();return(0,u.tZ)(wr,{...e,modelVersionFilter:t.modelVersionFilter,lifecycleFilter:t.lifecycleFilter})},Ar=e=>(0,u.tZ)(ft,{actions:Ir,children:(0,u.tZ)(Nr,{...e})}),Dr=()=>{const e=ke(),t=(r=e,(0,c.v9)((e=>r.map((t=>e.entities.experimentsById[t])).filter(Boolean)),((e,t)=>(0,a.isEqual)(e,t))));var r;const[n]=t,{fetchExperiments:s,isLoadingExperiment:l,requestError:o}=T();(0,i.useEffect)((()=>{s(e)}),[s,e]);const d=e.length>1;return o&&o.getErrorCode()===g.SM.PERMISSION_DENIED?(0,u.tZ)(S,{errorMessage:o.getMessageField()}):o&&o.getErrorCode()===g.SM.RESOURCE_DOES_NOT_EXIST?(0,u.tZ)(f.Z,{}):l||!n?(0,u.tZ)(h.OdW,{active:!0}):(0,u.BX)(u.HY,{children:[d?(0,u.tZ)(F,{experiments:t}):(0,u.BX)(u.HY,{children:[(0,u.tZ)(z,{experiment:n}),(0,u.tZ)(D,{}),(0,u.tZ)(b,{experiment:n}),(0,u.tZ)(I,{experiment:n})]}),(0,u.tZ)(Ar,{experiments:t})]})};const Lr={setExperimentTagApi:n.Yp,getExperimentApi:n.eu,setCompareExperiments:n.MY},Br=()=>(0,u.tZ)(p,{actions:Lr,children:(0,u.tZ)(Dr,{})});var Or=Br}}]);
//# sourceMappingURL=714.c7ed3611.chunk.js.map